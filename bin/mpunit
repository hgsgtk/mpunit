#!/usr/bin/env php
<?php declare(strict_types=1);

use MPUnit\TestResult;

require __DIR__ . '/../vendor/autoload.php';

// When assertion is failed, throw AssertError
ini_set('assert.exception', '1');

// When assertion is failed, omit PHP warning
assert_options(ASSERT_WARNING, '0');

// Set callback function
$testResult = new TestResult();

chdir(__DIR__);

foreach (glob('*_test.php') as $file) {
    try {
        include $file;
    } catch (\AssertionError $e) {
        $testResult->addError(
            $e->getFile(),
            $e->getLine(),
            $e->getMessage()
        );
    }
}

exit($testResult->endTest());
